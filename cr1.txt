from selenium import webdriver
import time

# Selenium WebDriver ka upyog karke browser ko kholo
driver = webdriver.Chrome()

# Azure Monitor dashboard ka URL
url = "https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoring_BrowseBlade/~/alertsV2"
driver.get(url)

# Wait for page to load
time.sleep(5)

# Find all rows containing alert information
rows = driver.find_elements_by_xpath("//div[@class='fxc-gc-rows']")

# Iterate through each row
for index, row in enumerate(rows, 1):
    # Find the link in the 'Affected resource' column
    link = row.find_element_by_xpath(".//a[contains(@class, 'fxc-gcflink-link')]")
    
    # Click on the 'Affected resource' link
    link.click()
    
    # Wait for the page to load
    time.sleep(5)
    
    # Capture screenshot of the 'Affected resource' page
    driver.save_screenshot(f'alert_{index}_affected_resource.png')
    
    # Go back to the previous page (the alert details)
    driver.back()
    
    # Wait for the page to load
    time.sleep(5)

# Quit the driver
driver.quit()
