import requests

# Your Azure AD credentials
CLIENT_ID = 'your_client_id'
TENANT_ID = 'your_tenant_id'
CLIENT_SECRET = 'your_client_secret'

# Microsoft Graph API endpoint for retrieving joined teams
teams_url = f'https://graph.microsoft.com/v1.0/me/joinedTeams'

# Get OAuth 2.0 access token
token_url = f'https://login.microsoftonline.com/{TENANT_ID}/oauth2/v2.0/token'
token_data = {
    'grant_type': 'client_credentials',
    'client_id': CLIENT_ID,
    'client_secret': CLIENT_SECRET,
    'scope': 'https://graph.microsoft.com/.default'
}
response = requests.post(token_url, data=token_data)
access_token = response.json().get('access_token')

# Get list of joined teams
headers = {'Authorization': 'Bearer ' + access_token}
teams_response = requests.get(teams_url, headers=headers)
teams_data = teams_response.json().get('value')

# Print list of joined teams
print("List of joined teams:")
for team in teams_data:
    print("- ", team['displayName'], "(Group ID:", team['id'], ")")
