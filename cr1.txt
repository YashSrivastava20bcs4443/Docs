from selenium import webdriver
import time

# Selenium WebDriver ka upyog karke browser ko kholo
driver = webdriver.Chrome()

# Azure Monitor dashboard ka URL
url = "https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoring_BrowseBlade/~/alertsV2"
driver.get(url)

# Wait for page to load
time.sleep(5)

# Find all alert elements
alert_elements = driver.find_elements_by_xpath("//div[@class='fxc-gc-row fxc-gc-row e azc-br-muted fxs-portal-hover fxs-portal-selected']")

# Iterate through each alert
for index, alert_element in enumerate(alert_elements, 1):
    # Find the second link inside the alert element
    links = alert_element.find_elements_by_tag_name("a")
    if len(links) >= 2:
        second_link = links[1]
        
        # Click on the second link
        second_link.click()
        
        # Wait for the page to load
        time.sleep(5)
        
        # Capture screenshot
        driver.save_screenshot(f'alert_{index}_affected_resource.png')
        
        # Go back to the previous page (the alert details)
        driver.back()
        
        # Wait for the page to load
        time.sleep(5)

# Quit the driver
driver.quit()
