from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.by import By
from webdriver_manager.chrome import ChromeDriverManager
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.common.keys import Keys
import time

# Function to perform Azure AD authentication
def azure_ad_login(email, password):
    # Set up Chrome options
    options = webdriver.ChromeOptions()
    options.add_argument("--disable-infobars")
    options.add_argument("--disable-extensions")
    options.add_argument("--start-maximized")
    options.add_argument("--disable-dev-shm-usage")
    options.add_argument("--no-sandbox")
    options.add_argument("--disable-gpu")
    options.add_argument("--window-size=1920x1080")
    
    # Initialize Chrome service
    service = Service(ChromeDriverManager().install())
    
    # Initialize Chrome driver with service and options
    driver = webdriver.Chrome(service=service, options=options)
    
    # Maximize window and set zoom level to 75%
    driver.maximize_window()
    driver.execute_script("document.body.style.zoom='75%'")
    
    # Navigate to Azure AD login page
    driver.get("https://login.microsoftonline.com/")
    
    # Find email field and input email
    WebDriverWait(driver, 10).until(EC.presence_of_element_located(EMAILFIELD)).send_keys(email)
    
    # Click next button
    WebDriverWait(driver, 10).until(EC.element_to_be_clickable(NEXTBUTTON)).click()
    
    # Find password field and input password
    WebDriverWait(driver, 10).until(EC.presence_of_element_located(PASSWORDFIELD)).send_keys(password)
    
    # Click sign in button
    WebDriverWait(driver, 10).until(EC.element_to_be_clickable(NEXTBUTTON)).click()
    
    # Wait for Azure AD authentication to complete
    time.sleep(10)  # Adjust sleep time as needed
    
    # Return the driver after authentication
    return driver

# Credentials
email = "your_email@example.com"
password = "your_password"

# Perform Azure AD authentication
driver = azure_ad_login(email, password)
