import requests
import base64

def encode_image(image_path):
    with open(image_path, "rb") as image_file:
        encoded_string = base64.b64encode(image_file.read()).decode("utf-8")
    return encoded_string

def send_message_to_teams(webhook_url, encoded_image):
    data = {
        "text": encoded_image
    }
    response = requests.post(webhook_url, json=data)
    if response.status_code == 200:
        print("Message sent successfully!")
    else:
        print("Failed to send message:", response.text)

# Main function
def main():
    # Path to the screenshot file
    image_path = "screenshot.png"

    # Encode screenshot image to base64
    encoded_image = encode_image(image_path)

    # Your Teams incoming webhook URL
    webhook_url = "YOUR_WEBHOOK_URL"

    # Send message to Teams with encoded image
    send_message_to_teams(webhook_url, encoded_image)

if __name__ == "__main__":
    main()
