import subprocess

def check_ssh(server_name, port=22):
    # Adding the -o StrictHostKeyChecking=no option to skip the host key confirmation prompt
    command = ["ssh", "-vp", str(port), "-o", "StrictHostKeyChecking=no", server_name]
    try:
        result = subprocess.run(command, capture_output=True, text=True, timeout=5)
        
        # Check if "Connection established" appears in stdout
        if "Connection established" in result.stdout:
            print(f"SSH connection successful for {server_name}")
            return True
        else:
            print(f"SSH connection failed for {server_name}")
            print(result.stderr)  # Print error message if available
            return False
    except subprocess.TimeoutExpired:
        print(f"SSH connection to {server_name} timed out")
        return False
    except Exception as e:
        print(f"An error occurred: {e}")
        return False
