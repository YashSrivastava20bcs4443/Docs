Here are the conditions for each column in your SQL query:

1. offered_calls (IVR Offered)

The call must be an inbound IVR call (isOutbound = 'False').

It must be related to mediaTypeId = '4' (assumed to be IVR).

The masterContactId must match contactId.


2. ivr_abandon (IVR Abandoned Calls)

The call must be an inbound IVR call (isOutbound = 'False').

mediaTypeId = '4'.

agentSeconds = 0 (no agent handled the call).

inQueueSeconds = 0 (never entered the queue).

preQueueSeconds > 1 (stayed in IVR for some time).

abandoned = 'False' (was not abandoned).

endReason = 'Contact Hung Up' (customer hung up in IVR).


3. queue_abandon (Queue Abandoned Calls)

The call must be an outbound queue call (isOutbound = 'True').

mediaTypeId = '4'.

agentSeconds = 0 (no agent handled the call).

inQueueSeconds > 0 (entered the queue but never connected to an agent).

preQueueSeconds > 0 (was in IVR before queueing).

abandoned = 'False' (was not abandoned by the system).


4. polite_disconnect (Closed by IVR)

The call must be an inbound IVR call (isOutbound = 'False').

mediaTypeId = '4'.

agentSeconds = 0 (no agent handled the call).

inQueueSeconds = 0 (never entered the queue).

preQueueSeconds > 1 (stayed in IVR for some time).

abandoned = 'False'.

endReason = 'Contact Hang Up via Script' (IVR script terminated the call).


5. answered (Answered Calls)

The call must be an inbound IVR call (isOutbound = 'False').

mediaTypeId = '4'.

abandoned = 'False'.

agentSeconds > 0 (call was connected to an agent).


This ensures that every column correctly reflects the conditions needed to avoid undefined values in your frontend. Let me know if you need modifications!
