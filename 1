SELECT 
    "toAddress" AS "To Address",
    COUNT("contactId") AS "Offered Calls",
    SUM(CASE WHEN "agentSeconds" > 0 THEN 1 ELSE 0 END) AS "Answered Calls",
    SUM(CASE 
        WHEN "preQueueSeconds" > 1 AND "inQueueSeconds" = 0 AND "agentSeconds" = 0 THEN 1 
        ELSE 0 
    END) AS "IVR Abandon",
    SUM(CASE 
        WHEN "inQueueSeconds" > 0 AND "agentSeconds" = 0 THEN 1 
        ELSE 0 
    END) AS "Queue Abandon",
    SUM(CASE 
        WHEN "endReason" IN ('Contact Hung Up', 'Contact Hang Up via Script') THEN 1 
        ELSE 0 
    END) AS "Polite Disconnect"
FROM 
    raw
GROUP BY 
    "toAddress";
