import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Load the data
file_path = 'your_excel_file.xlsx'  # Replace with actual file path
data = pd.read_excel(file_path)

# Check column names
print("Columns in dataset:", data.columns)

# Rename columns if necessary
data.rename(columns={
    'TimestampColumnInExcel': '@timestamp',  # Replace with actual timestamp column name
    'EventSourceColumnInExcel': 'Event Source',  # Replace with actual event source column name
    # Add more renames as needed
}, inplace=True)

# Convert @timestamp to datetime
data['@timestamp'] = pd.to_datetime(data['@timestamp'], errors='coerce')
print(data['@timestamp'].isnull().sum(), "rows have invalid timestamps.")

# Drop rows with invalid timestamps
data = data.dropna(subset=['@timestamp'])

# Extract Day and Hour
data['Day'] = data['@timestamp'].dt.date
data['Hour'] = data['@timestamp'].dt.hour

# Proceed with analysis and visualization
columns_to_keep = ['@timestamp', 'Event Source', 'EventNode', 'EventLevel', 'EventTitle', 'Day', 'Hour']
data = data[columns_to_keep]
