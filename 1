#!/bin/bash

# Update and install dependencies
sudo apt update && sudo apt upgrade -y
sudo apt install -y build-essential wget subversion libjansson-dev libxml2-dev libssl-dev \
                   libncurses5-dev libnewt-dev libcurl4-openssl-dev libtool bison \
                   flex python3-dev git

# Download and install Asterisk
cd /usr/src
sudo wget http://downloads.asterisk.org/pub/telephony/asterisk/asterisk-20-current.tar.gz
sudo tar -xzvf asterisk-20-current.tar.gz
cd asterisk-20*/

# Install required packages for Asterisk build
sudo contrib/scripts/install_prereq install

# Compile and install Asterisk
sudo ./configure
sudo make
sudo make install
sudo make samples
sudo make config

# Enable and start Asterisk service
sudo systemctl enable asterisk
sudo systemctl start asterisk

echo "Asterisk installation completed successfully!"
