async function applyFilter() {
    const startDate = document.getElementById('start-date').value;
    const endDate = document.getElementById('end-date').value;
    const portal = document.getElementById('portal').value;
    const tfn = document.getElementById('tfn-type').value;

    console.log('Filter values:', { startDate, endDate, portal, tfn }); // Debugging

    const queryParams = new URLSearchParams({
        startDate,
        endDate,
        portal,
        tfn
    });

    try {
        const response = await fetch(`http://localhost:3000/api/stats?${queryParams}`);
        if (!response.ok) {
            throw new Error('Network response is not ok');
        }
        const data = await response.json();
        document.getElementById('ivroffered').textContent = data.ivr_offered || 0;
        document.getElementById('ivrAbandoned').textContent = data.ivr_abandoned || 0;
        document.getElementById('queueAbandoned').textContent = data.queue_abandoned || 0;
        document.getElementById('closedByIvr').textContent = data.closed_by_ivr || 0;
        document.getElementById('abandonedUnder10').textContent = data.abandoned_in_10_sec || 0;
        document.getElementById('abandonedOver10').textContent = data.abandoned_in_over_10_sec || 0;
        document.getElementById('answeredCalls').textContent = data.answered_calls || 0;
        updateChart(data);
        updatePieChart(data);
    } catch (error) {
        console.error('Error Fetching stats:', error);
    }
}
