SELECT 
    to_addr AS "Number (toAddress)",
    COUNT(*) AS offered_calls,
    SUM(CASE WHEN abandoned = 'false' AND agentSeconds > 0 THEN 1 ELSE 0 END) AS answered,
    SUM(CASE WHEN abandoned = 'true' AND inQueueSeconds = 0 THEN 1 ELSE 0 END) AS ivr_abandon,
    SUM(CASE WHEN abandoned = 'true' AND inQueueSeconds > 0 THEN 1 ELSE 0 END) AS queue_abandon,
    SUM(CASE WHEN abandoned = 'true' AND endReason IN ('Contact Hung Up', 'Contact Hang Up via Script') THEN 1 ELSE 0 END) AS polite_disconnect
FROM raw
GROUP BY to_addr
ORDER BY offered_calls DESC;
