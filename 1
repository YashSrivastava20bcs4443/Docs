import requests
from requests.auth import HTTPBasicAuth
import json

# Unity system details
unity_ip = "10.1.3.96"  # Replace with your system's IP address
username = "your_username"  # Replace with your username
password = "your_password"  # Replace with your password

# API endpoint for system capacity (example endpoint, adjust as needed)
resource = "systemCapacity"
url = f"https://{unity_ip}/api/types/{resource}?compact=True"

# Authentication
auth = HTTPBasicAuth(username, password)

# Headers required by the Unity API
headers = {
    "Accept": "application/json",
    "Content-type": "application/json",
    "X-EMC-REST-CLIENT": "true"
}

# Disable SSL warnings
requests.packages.urllib3.disable_warnings(requests.packages.urllib3.exceptions.InsecureRequestWarning)

# Send GET request
response = requests.get(url, headers=headers, auth=auth, verify=False)

# Check if the request was successful
if response.status_code == 200:
    data = response.json()
    # Parse and extract system capacity details
    if 'entries' in data:
        for entry in data['entries']:
            content = entry['content']
            free_space = content.get('freeSpace', 'N/A')
            preallocated_space = content.get('preallocatedSpace', 'N/A')
            used_space = content.get('usedSpace', 'N/A')
            print(f"Free Space: {free_space}")
            print(f"Preallocated Space: {preallocated_space}")
            print(f"Used Space: {used_space}")
    else:
        print("No entries found in the response.")
else:
    print(f"Failed to fetch data, status code: {response.status_code}")
    print("Response content:", response.text)
