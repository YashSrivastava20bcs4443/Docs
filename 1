import pandas as pd
import matplotlib.pyplot as plt

# Excel file path
file_path = 'data.xlsx'

# Read Excel file (make sure to save your data with relevant headers)
df = pd.read_excel(file_path)

# Extract day and time from @timestamp
df['Day'] = pd.to_datetime(df['@timestamp']).dt.date
df['Time'] = pd.to_datetime(df['@timestamp']).dt.time

# Group by day for day-wise alerts
daywise_alerts = df.groupby(['Day', 'EventSource', 'EventLevel']).size().reset_index(name='Count')

# Group by time for time-wise alerts
timewise_alerts = df.groupby(['Time', 'EventSource', 'EventLevel']).size().reset_index(name='Count')

# Plotting day-wise alerts
plt.figure(figsize=(10, 6))
for source in daywise_alerts['EventSource'].unique():
    subset = daywise_alerts[daywise_alerts['EventSource'] == source]
    plt.plot(subset['Day'], subset['Count'], label=source)

plt.title('Day-wise Alerts')
plt.xlabel('Day')
plt.ylabel('Count')
plt.legend()
plt.xticks(rotation=45)
plt.tight_layout()
plt.show()

# Plotting time-wise alerts
plt.figure(figsize=(10, 6))
for source in timewise_alerts['EventSource'].unique():
    subset = timewise_alerts[timewise_alerts['EventSource'] == source]
    plt.scatter(subset['Time'], subset['Count'], label=source)

plt.title('Time-wise Alerts')
plt.xlabel('Time')
plt.ylabel('Count')
plt.legend()
plt.xticks(rotation=45)
plt.tight_layout()
plt.show()
