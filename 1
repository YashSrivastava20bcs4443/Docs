SELECT

    -- Closed by IVR (No agent or queue interaction, call ended in IVR)
    COUNT(*) FILTER (WHERE "masterContactId" = "contactId" 
                     AND "isOutbound" = 'False' 
                     AND "mediaTypeId" = '4' 
                     AND "agentSeconds"::numeric = 0 
                     AND "inQueueSeconds"::numeric = 0 
                     AND "abandoned" = 'False' 
                     AND "preQueueSeconds"::numeric > 0) AS closed_by_ivr,

    -- Abandoned in 10 Sec (Short abandonments within 10 seconds)
    COUNT(*) FILTER (WHERE "masterContactId" = "contactId" 
                     AND "isOutbound" = 'False' 
                     AND "mediaTypeId" = '4' 
                     AND "abandoned" = 'True' 
                     AND "preQueueSeconds"::numeric <= 10) AS abandoned_in_10_sec,

    -- Abandoned in >10 Sec (Longer abandonments)
    COUNT(*) FILTER (WHERE "masterContactId" = "contactId" 
                     AND "isOutbound" = 'False' 
                     AND "mediaTypeId" = '4' 
                     AND "abandoned" = 'True' 
                     AND "preQueueSeconds"::numeric > 10) AS abandoned_in_over_10_sec,

    -- Answered Calls (Successfully handled by agents)
    COUNT(*) FILTER (WHERE "masterContactId" = "contactId" 
                     AND "isOutbound" = 'False' 
                     AND "mediaTypeId" = '4' 
                     AND "abandoned" = 'False' 
                     AND "agentSeconds"::numeric > 0) AS answered_calls

FROM contact_data;

