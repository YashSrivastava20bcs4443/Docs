<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Details Page</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header>
        <div class="logo">Details Page</div>
        <nav>
            <ul>
                <li><a href="index.html">Back to Dashboard</a></li>
            </ul>
        </nav>
    </header>

    <div class="container">
        <h1 id="metric-title">Details</h1>

        <table class="data-table">
            <thead>
                <tr>
                    <th>TFN</th>
                    <th>Description</th>
                    <th>IVR Offered</th>
                    <th>IVR Abandoned</th>
                    <th>Queue Abandoned</th>
                    <th>Closed by IVR</th>
                    <th>Answered Calls</th>
                </tr>
            </thead>
            <tbody id="details-table-body">
                <!-- Data rows will be appended dynamically -->
            </tbody>
        </table>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const metric = urlParams.get('metric');
        document.getElementById('metric-title').textContent = `${metric} Details`;

        async function fetchDetails() {
            try {
                const response = await fetch(`http://localhost:3000/api/details?metric=${metric}`);
                const data = await response.json();

                const tableBody = document.getElementById('details-table-body');
                tableBody.innerHTML = '';

                data.forEach(row => {
                    tableBody.innerHTML += `
                        <tr>
                            <td>${row.tfn}</td>
                            <td>${row.description}</td>
                            <td>${row.ivr_offered}</td>
                            <td>${row.ivr_abandoned}</td>
                            <td>${row.queue_abandoned}</td>
                            <td>${row.closed_by_ivr}</td>
                            <td>${row.answered_calls}</td>
                        </tr>
                    `;
                });

            } catch (error) {
                console.error('Error fetching details:', error);
            }
        }

        fetchDetails();
    </script>

</body>

</html>
