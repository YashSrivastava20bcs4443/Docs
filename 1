import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart

def test_smtp(smtp_server, smtp_port, smtp_user, smtp_password, sender_email, recipient_email):
    try:
        # Create the message
        msg = MIMEMultipart()
        msg['From'] = sender_email
        msg['To'] = recipient_email
        msg['Subject'] = 'SMTP Test Email'
        
        # Add message body
        body = 'This is a test email to verify the SMTP server is working.'
        msg.attach(MIMEText(body, 'plain'))
        
        # Connect to the SMTP server
        server = smtplib.SMTP(smtp_server, smtp_port)
        server.starttls()  # Upgrade the connection to a secure encrypted SSL/TLS connection
        server.login(smtp_user, smtp_password)
        
        # Send the email
        server.sendmail(sender_email, recipient_email, msg.as_string())
        server.quit()
        
        print(f"Test email sent successfully to {recipient_email} via {smtp_server}.")
    except Exception as e:
        print(f"Failed to send email: {str(e)}")

# Example usage
smtp_server = 'smtp.yourserver.com'
smtp_port = 587
smtp_user = 'your_username'
smtp_password = 'your_password'
sender_email = 'sender@example.com'
recipient_email = 'recipient@example.com'

test_smtp(smtp_server, smtp_port, smtp_user, smtp_password, sender_email, recipient_email)
