(async function main() { 
  try {
    const authToken = await getAccessToken();
    const endDate = moment().tz("America/New_York").format("YYYY-MM-DDTHH:mm:ss[Z]");
    const startDate = moment().tz("America/New_York").subtract(1, "hour").format("YYYY-MM-DDTHH:mm:ss[Z]");

    const data = await fetchData(startDate, endDate, authToken);

    if (data.length > 0) {
      const csvFilePath = await saveRawDataToCsv(data);
      await dropTagsColumn(csvFilePath);
      await insertDataIntoDB(csvFilePath);
      deleteCsv(csvFilePath);
    } else {
      console.log("No data fetched for the given time range.");
    }
  } catch (error) {
    console.error("Error in execution:", error);
  }
})();
