def match_and_send_screenshot(csv_file):
    email_sent = False  # Flag to track if email has been sent
    with open(csv_file, newline='') as csvfile:
        reader = csv.DictReader(csvfile)
        for row in reader:
            if email_sent:  # Check if email has been sent
                break  # Break the loop if email has been sent
            api_name = row["API_Name"]
            email_address = row["Owner_Email"]
            for filename in os.listdir():
                if filename.startswith(api_name) and filename.endswith(".png"):
                    image_path = os.path.join(os.getcwd(), filename)
                    send_email(email_address, image_path)
                    email_sent = True  # Set flag to True after sending email

if __name__ == "__main__":
    match_and_send_screenshot("apis.csv")
